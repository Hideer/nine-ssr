{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nexport default /*#__PURE__*/(function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref, ctx) {\n    var _ctx$apiService;\n\n    var store, router, data;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            store = _ref.store, router = _ref.router;\n\n            if (!__isBrowser__) {\n              _context.next = 9;\n              break;\n            }\n\n            _context.next = 4;\n            return window.fetch('/api/index');\n\n          case 4:\n            _context.next = 6;\n            return _context.sent.json();\n\n          case 6:\n            _context.t0 = _context.sent;\n            _context.next = 12;\n            break;\n\n          case 9:\n            _context.next = 11;\n            return ctx === null || ctx === void 0 ? void 0 : (_ctx$apiService = ctx.apiService) === null || _ctx$apiService === void 0 ? void 0 : _ctx$apiService.index();\n\n          case 11:\n            _context.t0 = _context.sent;\n\n          case 12:\n            data = _context.t0;\n            _context.next = 15;\n            return store.dispatch('indexStore/initialData', {\n              payload: data\n            });\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n})();","map":{"version":3,"sources":["/Users/yumengcheng/Study/nine-ssr/web/pages/index/fetch.ts"],"names":["ctx","store","router","__isBrowser__","window","fetch","json","apiService","index","data","dispatch","payload"],"mappings":";;AAYA;AAAA,uEAAe,uBAAkCA,GAAlC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAASC,YAAAA,KAAT,QAASA,KAAT,EAAgBC,MAAhB,QAAgBA,MAAhB;;AAAA,iBAIAC,aAJA;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAI6BC,MAAM,CAACC,KAAP,CAAa,YAAb,CAJ7B;;AAAA;AAAA;AAAA,iCAIyDC,IAJzD;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAIwEN,GAJxE,aAIwEA,GAJxE,0CAIwEA,GAAG,CAAEO,UAJ7E,oDAIwE,gBAAiBC,KAAjB,EAJxE;;AAAA;AAAA;;AAAA;AAIPC,YAAAA,IAJO;AAAA;AAAA,mBAKPR,KAAK,CAACS,QAAN,CAAe,wBAAf,EAAyC;AAAEC,cAAAA,OAAO,EAAEF;AAAX,aAAzC,CALO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAf;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["import { Store } from 'vuex'\nimport { Route } from 'vue-router'\nimport { ISSRMidwayContext } from 'ssr-types'\nimport { IndexData } from '~/typings/data'\ninterface IApiService {\n  index: () => Promise<IndexData>\n}\ninterface Params {\n  store: Store<any>\n  router: Route\n}\n\nexport default async ({ store, router }: Params, ctx?: ISSRMidwayContext<{\n  apiService?: IApiService\n}>) => {\n  // 阅读文档获得更多信息 http://doc.ssr-fc.com/docs/features$fetch#%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%8E%AF%E5%A2%83\n  const data = __isBrowser__ ? await (await window.fetch('/api/index')).json() : await ctx?.apiService?.index()\n  await store.dispatch('indexStore/initialData', { payload: data })\n}\n"]},"metadata":{},"sourceType":"module"}