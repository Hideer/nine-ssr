{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nexport default /*#__PURE__*/(function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref, ctx) {\n    var _ctx$apiDeatilservice;\n\n    var store, router, data;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            store = _ref.store, router = _ref.router;\n\n            if (!__isBrowser__) {\n              _context.next = 9;\n              break;\n            }\n\n            _context.next = 4;\n            return window.fetch(\"/api/detail/\".concat(router.params.id));\n\n          case 4:\n            _context.next = 6;\n            return _context.sent.json();\n\n          case 6:\n            _context.t0 = _context.sent;\n            _context.next = 12;\n            break;\n\n          case 9:\n            _context.next = 11;\n            return ctx === null || ctx === void 0 ? void 0 : (_ctx$apiDeatilservice = ctx.apiDeatilservice) === null || _ctx$apiDeatilservice === void 0 ? void 0 : _ctx$apiDeatilservice.index(ctx.params.id);\n\n          case 11:\n            _context.t0 = _context.sent;\n\n          case 12:\n            data = _context.t0;\n            _context.next = 15;\n            return store.dispatch('detailStore/initialData', {\n              payload: data\n            });\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n})();","map":{"version":3,"sources":["/Users/yumengcheng/Study/nine-ssr/web/pages/detail/fetch.ts"],"names":["ctx","store","router","__isBrowser__","window","fetch","params","id","json","apiDeatilservice","index","data","dispatch","payload"],"mappings":";;AAaA;AAAA,uEAAe,uBAAkCA,GAAlC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAASC,YAAAA,KAAT,QAASA,KAAT,EAAgBC,MAAhB,QAAgBA,MAAhB;;AAAA,iBAIAC,aAJA;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAI6BC,MAAM,CAACC,KAAP,uBAA4BH,MAAM,CAACI,MAAP,CAAcC,EAA1C,EAJ7B;;AAAA;AAAA;AAAA,iCAI8EC,IAJ9E;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAI6FR,GAJ7F,aAI6FA,GAJ7F,gDAI6FA,GAAG,CAAES,gBAJlG,0DAI6F,sBAAuBC,KAAvB,CAA6BV,GAAG,CAACM,MAAJ,CAAWC,EAAxC,CAJ7F;;AAAA;AAAA;;AAAA;AAIPI,YAAAA,IAJO;AAAA;AAAA,mBAKPV,KAAK,CAACW,QAAN,CAAe,yBAAf,EAA0C;AAAEC,cAAAA,OAAO,EAAEF;AAAX,aAA1C,CALO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAf;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["import { Store } from 'vuex'\nimport { Route } from 'vue-router'\nimport { ISSRMidwayContext } from 'ssr-types'\nimport { IndexData } from '~/typings/data'\ninterface ApiDeatilservice {\n  index: (id: string) => Promise<IndexData>\n}\n\ninterface Params {\n  store: Store<any>\n  router: Route\n}\n\nexport default async ({ store, router }: Params, ctx?: ISSRMidwayContext<{\n  apiDeatilservice?: ApiDeatilservice\n}>) => {\n  // 阅读文档获得更多信息 http://doc.ssr-fc.com/docs/features$fetch#%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%8E%AF%E5%A2%83\n  const data = __isBrowser__ ? await (await window.fetch(`/api/detail/${router.params.id}`)).json() : await ctx?.apiDeatilservice?.index(ctx.params.id)\n  await store.dispatch('detailStore/initialData', { payload: data })\n}\n"]},"metadata":{},"sourceType":"module"}